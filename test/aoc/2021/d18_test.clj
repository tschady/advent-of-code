(ns aoc.2021.d18-test
  (:require [aoc.2021.d18 :as sut]
            [clojure.test :refer :all]))

(deftest magnitude
  (are [out in] (= out (sut/magnitude in))
    143  [[1,2],[[3,4],5]]
    1384 [[[[0,7],4],[[7,8],[6,0]]],[8,1]]
    3488 [[[[8,7],[7,7]],[[8,6],[7,7]]],[[[0,7],[6,6]],[8,7]]]))

(def example [[[[0,[5,8]],[[1,7],[9,6]]],[[4,[1,2]],[[1,4],2]]]
              [[[5,[2,8]],4],[5,[[9,9],0]]]
              [6,[[[6,2],[5,6]],[[7,6],[4,7]]]]
              [[[6,[0,7]],[0,9]],[4,[9,[9,0]]]]
              [[[7,[6,4]],[3,[1,3]]],[[[5,5],1],9]]
              [[6,[[7,3],[3,2]]],[[[3,8],[5,7]],4]]
              [[[[5,4],[7,7]],8],[[8,3],8]]
              [[9,3],[[9,9],[6,[4,9]]]]
              [[2,[[7,7],7]],[[5,8],[[9,3],[0,2]]]]
              [[[[5,2],5],[8,[3,7]]],[[5,[7,5]],[4,4]]]])

(deftest examples
  (is (= 4140 (sut/part-1 example)))
  (is (= 3993 (sut/part-2 example))))

(deftest reduce-snail
  (are [out in] (= out (sut/reduce-snail in))
    [[[[0,7],4],[[7,8],[6,0]]],[8,1]]   [[[[[4,3],4],4],[7,[[8,4],9]]],[1,1]]
    [[3,[2,[8,0]]],[9,[5,[7,0]]]]       [[3,[2,[8,0]]],[9,[5,[4,[3,2]]]]]))

(deftest challenges
  (is (= 4137 (sut/part-1 sut/input)))
  (is (= 4573 (sut/part-2 sut/input))))
